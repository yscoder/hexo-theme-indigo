!function(e,t){var n=t.body,a=t.querySelector.bind(t),s=t.querySelectorAll.bind(t),o=a("html"),r=a("#gotop"),c=a("#menu"),l=a("#header"),d=a("#mask"),f=a("#menu-toggle"),u=a("#menu-off"),v=a("#loading"),h=e.requestAnimationFrame,L=Array.prototype.forEach,g="ontouchstart"in e?"touchstart":"click",p=function(){},m=function(e){var t=e.offsetLeft,n=e.offsetTop;if(e.offsetParent){var i=arguments.callee(e.offsetParent);t+=i.x,n+=i.y}return{x:t,y:n}},y=navigator.userAgent.indexOf("Firefox")!==-1?t.documentElement:n,E={goTop:function(){var e=y.scrollTop;e>400?(y.scrollTop=e-400,h(arguments.callee)):y.scrollTop=0},toggleGotop:function(t){t>e.innerHeight/2?r.classList.add("in"):r.classList.remove("in")},toggleMenu:function(t){t?(c.classList.remove("hide"),e.innerWidth<1241&&(d.classList.add("in"),c.classList.add("show"),o.classList.add("lock"))):(c.classList.remove("show"),d.classList.remove("in"),o.classList.remove("lock"))},fixedHeader:function(e){e>l.clientHeight?l.classList.add("fixed"):l.classList.remove("fixed")},fixedToc:function(){function t(t){for(i=0,len=d.length;i<len;i++)if(t>m(d[i]).y-c){n.querySelector("li.active").classList.remove("active");var a=n.querySelector('a[href="#'+d[i].id+'"]').parentNode;a.classList.add("active"),a.offsetTop>=n.clientHeight-c?n.scrollTop=a.offsetTop-n.clientHeight+parseInt(e.innerHeight/3):n.scrollTop=0}t<m(d[0]).y&&(n.querySelector("li.active").classList.remove("active"),n.querySelector('a[href="#'+d[0].id+'"]').parentNode.classList.add("active"))}var n=a("#post-toc");if(!n||!n.children.length)return p;var o=m(n),r=o.y,c=l.clientHeight,d=a("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return n.querySelector('a[href="#'+d[0].id+'"]').parentNode.classList.add("active"),L.call(s('a[href^="#"]'),function(e){e.addEventListener("click",function(e){e.preventDefault(),y.scrollTop=m(a('[id="'+decodeURIComponent(this.hash).substr(1)+'"]')).y-c+10})}),function(e){e>r-c?n.classList.add("fixed"):n.classList.remove("fixed"),t(e)}}(),share:function(t){function n(t){e.open(encodeURI(h.replace("{service}",t)))}function i(){d.classList.add("in"),r.classList.add("in")}function o(){r.classList.remove("in"),d.classList.remove("in")}var r=a("#global-share"),c=a("#menu-share"),l=a("#post-share"),f=a("#share-fab"),u=s(".share-sns"),v=t.summary,h="http://www.jiathis.com/send/?webid={service}&url="+t.url+"&title="+t.title+"&summary="+v+"&pic="+location.protocol+"//"+location.host+t.pic;L.call(u,function(e){e.addEventListener("click",function(){n(this.dataset.service)},!1)}),c.addEventListener(g,i,!1),d.addEventListener(g,o,!1),f&&f.addEventListener(g,function(){l.classList.toggle("in")},!1)},search:function(){function e(){t.classList.toggle("in")}var t=a("#search-wrap");a("#search").addEventListener(g,e)},reward:function(){function e(){d.classList.add("in"),s.classList.add("ready"),setTimeout(function(){s.classList.add("in"),t.addEventListener(g,i)},0)}function n(){d.classList.remove("in"),s.classList.remove("in"),setTimeout(function(){s.classList.remove("ready"),t.removeEventListener(g,i)},300)}function i(e){s.contains(e.target)||n()}var s=a("#reward"),o=a("#rewardBtn"),r=a("#rewardOff");s&&(o.addEventListener(g,function(){return s.classList.contains("in")?n():e()}),r.addEventListener(g,n))}(),fixNavMinH:function(){function e(){t.style.minHeight=t.parentNode.clientHeight-t.nextElementSibling.offsetHeight+"px"}var t=a(".nav");return e}(),waterfall:function(){if(!(e.innerWidth<760)){var t=s(".waterfall");L.call(t,function(e){var t=e.querySelectorAll(".waterfall-item"),n=[0,0];L.call(t,function(e){var t=n[0]<=n[1]?0:1;e.style.cssText="top:"+n[t]+"px;left:"+(t>0?"50%":0),n[t]+=e.offsetHeight}),e.style.height=Math.max(n[0],n[1])+"px",e.classList.add("done")})}},tabBar:function(e){e.parentNode.parentNode.classList.toggle("expand")}};e.addEventListener("load",function(){E.fixNavMinH(),E.waterfall(),v.classList.remove("active")}),e.addEventListener("resize",function(){e.BLOG.even=g="ontouchstart"in e?"touchstart":"click",E.fixNavMinH(),E.toggleMenu(),E.waterfall()}),r.addEventListener(g,function(){h(E.goTop)},!1),f.addEventListener(g,function(e){E.toggleMenu(!0),e.preventDefault()},!1),u.addEventListener(g,function(){c.classList.add("hide")},!1),d.addEventListener(g,function(){E.toggleMenu()},!1),t.addEventListener("scroll",function(){var e=y.scrollTop;E.toggleGotop(e),E.fixedHeader(e),E.fixedToc(e)},!1),e.BLOG.SHARE&&E.share(e.BLOG.SHARE),E.docEl=y,E.noop=p,E.even=g,E.$=a,E.$$=s,Object.keys(E).reduce(function(e,t){return e[t]=E[t],e},e.BLOG),Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])}(window,document);